{% extends "base.html" %}
{% block content %}
<div class="bg-white dark:bg-gray-800 p-6 rounded-2xl shadow-lg">
  <h2 class="text-xl font-semibold mb-4">Settings</h2>

  <div class="space-y-6">
    <!-- Trusted Domains -->
    <section>
      <h3 class="text-lg font-semibold mb-2">Trusted Domains</h3>
      <textarea id="trustedDomains" rows="4" class="w-full border dark:border-gray-600 bg-gray-50 dark:bg-gray-700 p-3 rounded-lg"
        placeholder="example.com&#10;safe.org"></textarea>
      <button onclick="saveTrusted()" class="mt-2 px-4 py-2 bg-green-600 hover:bg-green-500 text-white rounded-lg transition">
        ðŸ’¾ Save Domains
      </button>
    </section>

    <!-- Clear History -->
    <section>
      <h3 class="text-lg font-semibold mb-2">History</h3>
      <button onclick="clearHistory()" class="px-4 py-2 bg-red-600 hover:bg-red-500 text-white rounded-lg transition">
        ðŸ§¹ Clear All History
      </button>
    </section>
  </div>
</div>

<script>
async function saveTrusted() {
  const domains = document.getElementById("trustedDomains").value
    .split("\n").map(v => v.trim()).filter(v => v);
  const res = await fetch("/api/save_trusted_domains", {
    method: "POST",
    headers: {"Content-Type": "application/json"},
    body: JSON.stringify({ trusted_domains: domains })
  });
  const data = await res.json();
  alert("âœ… Trusted domains updated.");
}

async function clearHistory() {
  if (!confirm("Are you sure you want to clear all history?")) return;
  await fetch("/api/clear_history", { method: "POST" });
  alert("ðŸ§¹ History cleared.");
}
</script>
{% endblock %}
